<!-- To run this code
	-Navigate to this directory in Terminal (using "cd", "ls")
	-Type "http-server &" and press enter
	-Copy/Paste the http address into Chrome
	-Add "/plotkeplercoords to the end of the address" !-->
<!DOCTYPE html>
<html >
<style type="text/css">
	text{
		font: 14px sans-serif;
	}
</style>
<head>
  <meta charset="UTF-8">
  <title>Kepler coordinate scatterplot</title>
  
</head>

<body>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script>
  	// varaibles for page sizing
  	var margin = {top: 20, right: 20, bottom: 20, left: 40};
  	var width = 500 - margin.left - margin.right;
  	var height = 500 - margin.top - margin.bottom;

  	var svg = d3.select("body")
        .append("div")
        .classed("svg-container", true) //container class to make it responsive
        .append("svg")
        //responsive SVG needs these 2 attributes and no width and height attr
        .attr("preserveAspectRatio", "xMinYMin meet")
        .attr("viewBox", "0 0 1000 1000")
        //class to make it responsive
        .classed("svg-content-responsive", true)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  	// set up the svg object (the "canvas")
  	var svg = d3.select("body").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


        //function to create a "star" object
        function star(id, name, RA, dec, mag){
        	this.id = id;
        	this.name = name;
        	this.RA = RA;
        	this.dec = dec;
        	this.mag = mag;
        }

        //create a variable to hold an array of "star" objects
        var keplerData = [];
        //call the existing d3.csv function to read in and plot the kepler data
        d3.csv("./KOIarchive.csv", function(csvdata){
        	//console.log (csvdata.length);

        	//for each line in csvdata, create a "star" object and append it to the existing keplerData array
        	for(i=0; i<csvdata.length; i++){
        		//the + is shorthand for forcing js to interpret something as a number instead of a string.
			//create a star and put data in it
			var rowStar = new star(id = +csvdata[i].kepid,
										name = csvdata[i].kepoi_name,
										RA = +csvdata[i].ra,
										dec = +csvdata[i].dec,
										mag = +csvdata[i].koi_kepmag);

			//append star object to keplerData
			keplerData.push(rowStar);
        	}

        	console.log(keplerData);

        	//set up x- and y- axis transformations
        	var xScale = d3.scaleLinear()
        		.domain([280, 302])
        		.range([0, width]);
			var yScale = d3.scaleLinear()
        		.domain([36., 53.])
        		.range([height, 0.]);




        	var xAxis = d3.axisBottom().scale(xScale);
        	var yAxis = d3.axisLeft().scale(yScale);

        	// draw the x- axis
        	svg.append("g")
        		.attr("class", "xaxis") // object type is now "g.axis"
        		.attr("transform", "translate(0,"+height+")")
        		.call(xAxis);

        	svg.append("text") //adding label "RA"
        		.attr("class","label")
        		.attr("transform", "translate(0,"+height+")")
        		.attr("x", width)
        		.attr("y", -6)
        		.style("text-anchor", "end")
        		.style("font-weight", "bold")
        		.text("RA");

        	//draw y- axis
        	svg.append("g")
        		.attr("class", "yaxis") // object type is now "g.axis"
        		// .attr("transform", "translate("+width+", height)")
        		.call(yAxis);


        	svg.append("text") //adding label "Dec"
        		.attr("class","label")
        		// .attr("transform", "translate("+width+", height)")
        		.attr("x", 0)
        		.attr("y", 0)
        		.style("text-anchor", "end")
        		.style("font-weight", "bold")
        		.text("Dec");

        	//Plotting data
        	svg.selectAll("circle")
        			.data(keplerData)
        		.enter().append("circle")
        		.style("r","1px")
        		.style("fill","steelblue")
        		.attr("cx", function(d) {return xScale(d.RA)})
        		.attr("cy", function(d) {return yScale(d.dec)});








        })


  </script> 

</body>
</html>
